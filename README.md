# ЛР 5. Синтаксичний аналізатор (Lex + YACC)

Ця програма, реалізована за допомогою Yacc та Lex, створює простий калькулятор, який може парсити та обчислювати арифметичні вирази. Нижче наведено детальний опис її роботи.

## 1. Лексичний аналіз за допомогою Lex
   Програма починається з використання Lex для визначення лексем (основних складових елементів виразів), які вона розпізнає. У файлі Lex визначено наступні лексеми:
   - **Числа**: Цілі числа зчитуються як послідовності цифр і перетворюються на цілі значення за допомогою `atoi`.
   - **Оператори**: Програма розпізнає основні арифметичні оператори `+`, `-`, `*`, `/`, `%` та групувальні дужки `(` і `)`.
   - **Ігнорування пробілів та табуляцій**: Lex-програма пропускає пробіли та символи табуляції, оскільки вони не впливають на обчислення.
  ```c
  %%
[0-9]+ {
          yylval=atoi(yytext);
          return NUMBER;
       }
[\t] ;
[\n] return 0;
. return yytext[0];
%%
  ```

   Після цього Lex передає кожну знайдену лексему на обробку Yacc для побудови виразів і виконання обчислень.

## 2. Синтаксичний аналіз за допомогою Yacc
   Yacc будує синтаксичне дерево для обчислення виразів, визначаючи правила, за якими компонуються лексеми. Основні правила включають:
   - **Операції**: Правила описують, як об’єднуються числа й оператори для формування повних виразів.
   ```c
%%

ArithmeticExpression: E {
        printf("\nResult=%d\n", $$);
        return 0;
    }
;

E: E '+' E { $$ = $1 + $3; }
 | E '-' E { $$ = $1 - $3; }
 | E '*' E { $$ = $1 * $3; }
 | E '/' E { $$ = $1 / $3; }
 | E '%' E { $$ = $1 % $3; }
 | '(' E ')' { $$ = $2; }
 | NUMBER { $$ = $1; }
;

%%
```
   - **Пріоритет операторів**: Yacc задає пріоритет операторів, щоб коректно обчислювати складні вирази, наприклад, виконуючи множення та ділення перед додаванням і відніманням.
   - **Обробка дужок**: Дужки дозволяють змінювати порядок обчислень у виразі, змушуючи виконувати певні операції раніше за інші.
  ```c
  %left '+' '-'
  %left '*' '/' '%'
  %left '(' ')'
  ```
  Директива `%left` визначає, що оператори, перелічені після неї, мають лівосторонню асоціативність.
Це означає, що під час обчислення виразів з операторами однакового пріоритету, парсер буде обробляти їх зліва направо.
Наприклад, у виразі `1 - 2 - 3`, операції будуть обчислюватись як `(1 - 2) - 3`.


## 3. Принцип роботи
   
У парсері Yacc операції на зразок додавання, віднімання, множення тощо працюють за принципом **shift-reduce**. Це означає, що парсер поступово "зсуває" (shift) токени у стек доти, доки не зустріне шаблон, що відповідає одному з визначених правил граматики. Після цього він виконує скорочення (reduce), об'єднуючи токени у стеку в один елемент, який представляє підвираз. Цей процес повторюється, поки всі токени не будуть зведені до одного фінального виразу або не виникне помилка. Парсер використовує принцип shift-reduce для об'єднання чисел і операторів у завершений вираз.

### Розглянемо на прикладі `3 + 4 * 2`

### Shift (Зсув)
Парсер послідовно зсуває (додає) токени у стек, поки не зустріне повний підвираз, який відповідає одному з правил. Наприклад, для виразу `3 + 4 * 2` він буде додавати (shift) `3`, потім `+`, `4`, `*`, і `2` до стеку.

### Reduce (Скорочення)
Після того як парсер має достатньо елементів у стеку, щоб відповідати правилу, він виконує скорочення. Наприклад:

- Коли в стеку є `4 * 2`, парсер виконує скорочення (reduce) за правилом `E '*' E`, що призводить до обчислення `4 * 2` і зберігання результату `8` у стеку.
- Далі, коли залишилися `3 + 8`, парсер знову скорочує цей підвираз, використовуючи правило `E '+' E` і обчислюючи результат `3 + 8 = 11`.

### Завершення або помилка
- Якщо всі скорочення виконані, і в стеку залишається тільки один підвираз, це вказує на успішне завершення обробки виразу.
- Якщо парсер не може виконати скорочення або залишаються незавершені підвирази, це сигналізує про помилку синтаксису.


## 4. Виведення результату
   Після того, як Yacc обробляє вираз і виконує обчислення, програма виводить результат. Наприклад, при введенні виразу `3 + 4 * 2`, програма правильно застосовує порядок операцій і обчислює вираз як `3 + (4 * 2) = 11`.
   
![image](https://github.com/user-attachments/assets/06cab663-697c-46b2-851e-8f64a51aa23f)

## 5. Обробка помилок
   Якщо користувач вводить некоректний вираз, програма використовує функцію `yyerror`, яка виводить повідомлення про помилку. Це дозволяє уникнути аварійного завершення роботи програми та повідомляє користувача про те, що введений вираз некоректний.

   ![image](https://github.com/user-attachments/assets/ed115074-a724-49a0-b763-17993732fc67)

Таким чином, програма працює як базовий калькулятор, здатний обробляти арифметичні вирази з числами та основними операціями, виконуючи лексичний і синтаксичний аналіз, обчислення виразу та обробку помилок.


### Результат (ще пару прикладів роботи)

![image](https://github.com/user-attachments/assets/69e2c55f-7aa6-4654-b447-4cc945ace852)
